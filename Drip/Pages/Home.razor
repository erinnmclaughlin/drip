@page "/"

<PageTitle>Home</PageTitle>

<div class="drip-page-content">
    <h1>@OpenApiDocument.Info.Title <span>v@(OpenApiDocument.Info.Version)</span></h1>
    @if (OpenApiDocument.Info.Description is { Length: > 0 } description)
    {
        <div>
            @((MarkupString)RenderMarkdownWithLinksNewTab(description))
        </div>
    }
</div>

@code {

    [CascadingParameter]
    public required OpenApiDocument OpenApiDocument { get; set; }

    private static string RenderMarkdownWithLinksNewTab(string markdown)
    {
        var html = Markdig.Markdown.ToHtml(markdown);
        // Add target="_blank" and rel="noopener noreferrer" to all <a> tags
        return System.Text.RegularExpressions.Regex.Replace(
            html,
            "<a\\s",
            "<a target=\"_blank\" rel=\"noopener noreferrer\" ",
            System.Text.RegularExpressions.RegexOptions.IgnoreCase
        );
    }
}
